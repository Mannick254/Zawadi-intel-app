{"version":3,"file":"FeaturedStories-CTcHju5S.js","sources":["../../src/components/FeaturedStories.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { supabase } from \"../supabaseClient\";\nimport styles from \"./FeaturedStories.module.css\";\nimport ReactMarkdown from \"react-markdown\";\nimport remarkGfm from \"remark-gfm\";\n\nconst FeaturedStories = () => {\n  const [mainStory, setMainStory] = useState(null);\n  const [sideStories, setSideStories] = useState([]);\n  const [mustRead, setMustRead] = useState([]);\n  const [mostRelevant, setMostRelevant] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [errorMsg, setErrorMsg] = useState(null);\n\n  useEffect(() => {\n    const fetchStories = async () => {\n      setLoading(true);\n\n      try {\n        // Featured stories\n        const { data: featured, error: featuredError } = await supabase\n          .from(\"articles\")\n          .select(\"*\")\n          .eq(\"published\", true)\n          .eq(\"section\", \"feature\")\n          .order(\"created_at\", { ascending: false });\n\n        if (featuredError) throw featuredError;\n\n        if (featured && featured.length > 0) {\n          setMainStory(featured[0]);\n          setSideStories(featured.slice(1, 5));\n        }\n\n        // MUST READ\n        const { data: mustReadData, error: mustReadError } = await supabase\n          .from(\"articles\")\n          .select(\"*\")\n          .eq(\"published\", true)\n          .eq(\"must_read\", true)\n          .order(\"created_at\", { ascending: false });\n\n        if (mustReadError) throw mustReadError;\n        setMustRead(mustReadData || []);\n\n        // MOST RELEVANT\n        const { data: mostRelevantData, error: mostRelevantError } = await supabase\n          .from(\"articles\")\n          .select(\"*\")\n          .eq(\"published\", true)\n          .eq(\"most_relevant\", true)\n          .order(\"created_at\", { ascending: false });\n\n        if (mostRelevantError) throw mostRelevantError;\n        setMostRelevant(mostRelevantData || []);\n\n      } catch (err) {\n        console.error(\"Error loading stories:\", err.message);\n        setErrorMsg(\"Failed to load stories.\");\n      }\n\n      setLoading(false);\n    };\n\n    fetchStories();\n  }, []);\n\n  if (loading) return <p className={styles.status}>Loading stories...</p>;\n  if (errorMsg) return <p className={styles.error}>{errorMsg}</p>;\n  if (!mainStory) return <p className={styles.status}>No featured stories available at the moment.</p>;\n\n  return (\n    <section id=\"featured-stories\" className={styles.featuredStories}>\n      <div className={styles.featuredHeader}></div>\n\n      <div className={styles.featuredLayout}>\n        {/* Hero story */}\n        <article className={styles.mainStory}>\n          {mainStory.image_url && (\n            <div className={styles.mainImage}>\n              <a href={`/articles/${mainStory.slug || mainStory.id}`}>\n                <img\n                  src={mainStory.image_url}\n                  alt={mainStory.title || \"Featured story image\"}\n                  loading=\"lazy\"\n                />\n              </a>\n            </div>\n          )}\n          <div className={styles.mainContent}>\n            <h3 className={styles.mainTitle}>\n              <a href={`/articles/${mainStory.slug || mainStory.id}`}>\n                {mainStory.title}\n              </a>\n            </h3>\n            <div className={styles.mainExcerpt}>\n              <ReactMarkdown remarkPlugins={[remarkGfm]}>\n                {mainStory.content ? `${mainStory.content.slice(0, 160)}...` : \"\"}\n              </ReactMarkdown>\n            </div>\n            <time className={styles.storyDate} dateTime={mainStory.created_at}>\n              {new Date(mainStory.created_at).toLocaleDateString(\"en-US\", {\n                year: \"numeric\",\n                month: \"long\",\n                day: \"numeric\",\n              })}\n            </time>\n          </div>\n        </article>\n\n        {/* Side stories */}\n        <div className={styles.sideStories}>\n          {sideStories.map((story) => (\n            <article className={styles.sideCard} key={story.id}>\n              <div className={styles.sideContent}>\n                <h4 className={styles.sideTitle}>\n                  <a href={`/articles/${story.slug || story.id}`}>\n                    {story.title}\n                  </a>\n                </h4>\n                <time className={styles.storyDate} dateTime={story.created_at}>\n                  {new Date(story.created_at).toLocaleDateString(\"en-US\", {\n                    month: \"short\",\n                    day: \"numeric\",\n                  })}\n                </time>\n              </div>\n              {story.image_url && (\n                <div className={styles.sideImage}>\n                  <a href={`/articles/${story.slug || story.id}`}>\n                    <img\n                      src={story.image_url}\n                      alt={story.title || \"Story image\"}\n                      loading=\"lazy\"\n                    />\n                  </a>\n                </div>\n              )}\n            </article>\n          ))}\n        </div>\n\n        {/* Third column */}\n        <aside className={styles.thirdColumn}>\n          <div className={styles.mustRead}>\n            <div className={styles.mustReadHeading}>\n              <ReactMarkdown remarkPlugins={[remarkGfm]}>\n                {`### **MUST READ**`}\n              </ReactMarkdown>\n            </div>\n            <div className={styles.mustReadList}>\n              {mustRead.map((story) => (\n                <div key={story.id} className={styles.mustReadItem}>\n                  <a href={`/articles/${story.slug || story.id}`}>\n                    {story.title}\n                  </a>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          <hr className={styles.separator} />\n\n          <div className={styles.mostRelevant}>\n            <div className={styles.mostRelevantHeading}>\n              <ReactMarkdown remarkPlugins={[remarkGfm]}>\n                {`### **MOST RELEVANT**`}\n              </ReactMarkdown>\n            </div>\n            <div className={styles.relevantList}>\n              {mostRelevant.map((story) => (\n                <div key={story.id} className={styles.relevantItem}>\n                  <a href={`/articles/${story.slug || story.id}`}>\n                    {story.title}\n                  </a>\n                </div>\n              ))}\n            </div>\n          </div>\n        </aside>\n      </div>\n    </section>\n  );\n};\n\nexport default FeaturedStories;\n"],"names":["FeaturedStories","mainStory","setMainStory","useState","sideStories","setSideStories","mustRead","setMustRead","mostRelevant","setMostRelevant","loading","setLoading","errorMsg","setErrorMsg","useEffect","featured","featuredError","supabase","mustReadData","mustReadError","mostRelevantData","mostRelevantError","err","jsx","styles","jsxs","ReactMarkdown","remarkGfm","story"],"mappings":"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"}